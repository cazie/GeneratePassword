@page
@model GeneratePassword.Pages.TheCodeModel
@{
}
<head>
    <link href="css/prism.css" rel="stylesheet">
    <link rel="icon" type="image/png" href="img/favicon-32x32.png" />
</head>

<main class="flex-shrink-0">
    <div class="container py-5 px-5 mt-2">
        <h2 class="border-1 border-bottom border-dark">The Code for Password Generator</h2>
        <div class="row row-cols-1 row-cols-lg-2">
            <div class="col-lg-9">
                <pre class="line-numbers">
                    <code class="language-javascript">

                        public static class GeneratorHelper
                        {

                        public static string GeneratePassword(int maxLen, bool Caps, bool Symb, bool numbs)
                        {
                        Random rand = new Random();

                        string output = "";
                        int minCaps = 1;
                        int minSymbols = 1;
                        int minNumbers = 1;
                        if (Caps == true)
                        {
                        output += GetCaps(minCaps);

                        }

                        if (Symb)
                        {
                        output += GetSymbols(minSymbols);
                        }


                        if (numbs)
                        {
                        output += GetNumbers(minNumbers);
                        }


                        int minRemaining = maxLen - (output.Length);

                        output += GetRemaining(minRemaining);



                        Random randAll = new Random();

                        // Create new string from the reordered char array
                        //https:///stackoverflow.com/questions/4739903/shuffle-string-c-sharp
                        string outputFinal = new string(output.ToCharArray()
                        .OrderBy(s => (randAll.Next(2) % 2) == 0).ToArray());




                        return outputFinal;
                        }




                        private static string GetSymbols(int minSymbols)
                        {
                        string output = "";
                        string symbols = "!@@#$%&*)(";
                        Random randSymbols = new Random();


                        for (int i = 0; i < minSymbols; i++)
                        {
                        int numSymbols = randSymbols.Next(symbols.Length);
                        output += symbols[numSymbols];
                        }
                        return output;
                        }

                        private static string GetNumbers(int minNumbers)
                        {
                        string output = "";
                        string numbers = "1234567890";
                        Random randNumbers = new Random();


                        for (int i = 0; i < minNumbers; i++)
                        {
                        int numNumbers = randNumbers.Next(numbers.Length);
                        output += numbers[numNumbers];
                        }
                        return output;
                        }

                        private static string GetCaps(int minCaps)
                        {
                        string selectCharacters = "abcdefghijklmnopqrstuvwxyz";
                        string output = "";
                        string caps = selectCharacters.ToUpper();
                        Random randCaps = new Random();


                        for (int i = 0; i < minCaps; i++)
                        {
                        int numCaps = randCaps.Next(caps.Length);
                        output += caps[numCaps];
                        }
                        return output; //XX
                        }
                        private static string GetRemaining(int minRem)
                        {
                        string selectCombined = "abcdefghijklmnopqrstuvwxyz!@@#$%&*)(1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                        string output = "";

                        Random randRem = new Random();


                        for (int i = 0; i < minRem; i++)
                        {
                        int numCaps = randRem.Next(selectCombined.Length);
                        output += selectCombined[numCaps];
                        }
                        return output; //XX
                        }

                        // future refactoring

                        public static bool IsStrong(string password)
                        {
                        bool hasUpper = false; bool hasLower = false; bool hasDigit = false;
                        for (int i = 0; i < password.Length && !(hasUpper && hasLower && hasDigit); i++)
                        {
                        char c = password[i];
                        if (!hasUpper) hasUpper = char.IsUpper(c);
                        if (!hasLower) hasLower = char.IsLower(c);
                        if (!hasDigit) hasDigit = char.IsDigit(c);

                        }
                        return hasUpper && hasLower && hasDigit;
                        }

                        public static bool GetStrength(string password)
                        {
                        bool hasLower = false; bool hasUpper = false; bool hasSymbol = false; bool hasDigit = false;
                        for (int i = 0; i < password.Length; i++)
                        {
                        hasUpper = Char.IsUpper(password[i]);
                        hasDigit = Char.IsDigit(password[i]);
                        hasLower = Char.IsLower(password[i]);
                        hasSymbol = ContainsSpecialChars(password[i].ToString());

                        }

                        return hasUpper && hasSymbol && hasDigit && hasLower;

                        }

                        private static bool ContainsSpecialChars(string value)
                        {
                        char[] symbolList = { '!', '@@', '#', '$', '%', '&', '*', ')', '(' };
                        return symbolList.Any(value.Contains);
                        }

                        }

                    </code>
                    </pre>

            </div>
            <div class="col-lg-3">
                <h5>Password Generator</h5>
                <p>Generate Strong Passwords</p>
                <p>the Code is stuctured in in several functions, pulling each character sector separately.</p>
                <p>Serveral approaches</p>
                <p>
                    Can combine all character types BUT it is not always a guarantee that a cap, number or symbol will be selected, as the randomization process does
                    not distinguish whether to select a number, letter or symbol.
                </p>
                <p>Creating separate random results for each character sector ensures that at least 1 cap, symbol, number is selected</p>
                <p>If opt not to include the "Musts" means that these characters can still be in te result as the overall pool has ALL characters</p>
                <h6>Possible Enhancements</h6>
                <ul>
                    <li>Check Strength</li>
                    <li>Choice of # in character sector</li>
                    <li>Place password in the clipboard</li>
                    <li>Make prettier</li>
                </ul>

            </div>
        </div>
    </div>
</main>
@section scripts{ 

    <script src="js/prism.js"></script>
<script>
        Prism.plugins.NormalizeWhitespace.setDefaults({
            'remove-trailing': true,
            'remove-indent': true,
            'left-trim': true,
            'right-trim': true
        })

    </script>

}